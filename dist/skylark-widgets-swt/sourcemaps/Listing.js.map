{"version":3,"sources":["Listing.js"],"names":["define","langx","$","swt","Widget","Listing","inherit","klassName","pluginName","options","multiSelect","multiTier","mode","levels","selectors","children","hasChildren","classes","expandIcon","collapseIcon","templates","tree","item","itemGroup","toggle","active","selected","state","Object","_init","this","overrided","self","velm","_velm","itemSelector","_$items","on","veItem","_elmx","hasClass","value","data","undefined","index","set","$this","$toggle","query","each","is","find","remove","text","trim","html","addClass","append","has","not","e","preventDefault","closest","toggleClass","collapse","siblings","removeClass","_refresh","updates","findItem","valueOrIdx","isNumber","eq","filter","oldValue","selectOneItem"],"mappings":"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","file":"../Listing.js","sourcesContent":[" define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"./swt\",\r\n  \"./Widget\"\r\n],function(langx,$,swt,Widget){\r\n\r\n    var Listing = Widget.inherit({\r\n        klassName : \"Listing\",\r\n\r\n        pluginName : \"lark.listing\",\r\n\r\n        options : {\r\n        \tmultiSelect: false,\r\n        \t//multiTier : false,\r\n\r\n          multiTier : {\r\n            mode   : \"\",  // \"tree\" or \"accordion\" or \"popup\"\r\n            levels : 2,\r\n            selectors :  {\r\n              children : \"> ul\",  // \"> .list-group\"\r\n              hasChildren : \":has(ul)\"\r\n            },\r\n            classes : {\r\n              expandIcon: 'glyphicon glyphicon-plus',    // \"glyphicon-chevron-down\"\r\n              collapseIcon: 'glyphicon glyphicon-minus', // \"glyphicon-chevron-right\"\r\n              children : \"\"                              // \"list-group children\"\r\n            },\r\n            templates : {\r\n              tree : {\r\n                item : \"<span><i class=\\\"glyphicon\\\"></i><a href=\\\"javascript: void(0);\\\"></a> </span>\",\r\n                itemGroup: \"\"\r\n\r\n              }\r\n                            \r\n            }\r\n          },\r\n\r\n        \ttoggle : false,\r\n        \tclasses : {\r\n          \tactive : \"active\"\r\n        \t},\r\n        \tselectors : {\r\n          \titem : \"li\"                   // \".list-group-item\"\r\n        \t},\r\n        \tselected : 0\r\n        },\r\n\r\n        state : {\r\n          selected : Object\r\n        },\r\n\r\n        _init : function() {\r\n            this.overrided();\r\n            var self = this,\r\n                velm = this._velm,\r\n                itemSelector = this.options.selectors.item;\r\n\r\n            this._$items = velm.$(itemSelector);\r\n\r\n            velm.on('click', itemSelector, function () {\r\n                var veItem = self._elmx(this);\r\n\r\n                if (!veItem.hasClass('disabled')) {\r\n                  var value = veItem.data(\"value\");\r\n                  if (value === undefined) {\r\n                    value = self._$items.index(this);\r\n                  }\r\n                  self.state.set(\"selected\",value);\r\n                }\r\n\r\n                //veItem.blur();\r\n                return false;\r\n            });\r\n            this.state.set(\"selected\",this.options.selected);\r\n\r\n            var $this = velm,\r\n                $toggle = this.options.toggle,\r\n                multiTierMode = this.options.multiTier.mode,\r\n                obj = this;\r\n\r\n            if (multiTierMode == \"tree\") {\r\n                 $this.query(this.options.selectors.item).each(function(){\r\n                   if($(this).is(self.options.multiTier.selectors.hasChildren)) {\r\n                      var children = $(this).find(' > ul');\r\n                      $(children).remove();\r\n                      text = $(this).text().trim();\r\n                      $(this).html(self.options.multiTier.templates.tree.item);\r\n                      $(this).find(' > span > i').addClass('glyphicon-folder-open');\r\n                      $(this).find(' > span > a').text(text);\r\n                      $(this).append(children);\r\n                    }  else {\r\n                      text = $(this).text().trim();\r\n                      $(this).html(self.options.multiTier.templates.tree.item);\r\n                      $(this).find(' > span > i').addClass('glyphicon-file');\r\n                      $(this).find(' > span > a').text(text);\r\n                  }\r\n\r\n                 });\r\n            }\r\n\r\n            //if (this.isIE() <= 9) {\r\n            //    $this.find(\"li.active\").has(\"ul\").children(\"ul\").collapse(\"show\");\r\n            //    $this.find(\"li\").not(\".active\").has(\"ul\").children(\"ul\").collapse(\"hide\");\r\n            //} else {\r\n                $this.query(\"li.active\").has(\"ul\").children(\"ul\").addClass(\"collapse in\");\r\n                $this.query(\"li\").not(\".active\").has(\"ul\").children(\"ul\").addClass(\"collapse\");\r\n            //}\r\n\r\n\r\n\r\n\r\n            $this.query(\"li\").has(\"ul\").find(\"a\").on(\"click\" + \".\" + this.pluginName, function(e) {\r\n                e.preventDefault();\r\n\r\n                $(this).closest(\"li\").toggleClass(\"active\").children(\"ul\").collapse(\"toggle\");\r\n\r\n                if ($toggle) {\r\n                    $(this).closest(\"li\").siblings().removeClass(\"active\").children(\"ul.in\").collapse(\"hide\");\r\n                }\r\n\r\n            });\r\n\r\n\r\n        },\r\n\r\n        _refresh : function(updates) {\r\n          this.overrided(updates);\r\n          var self  = this;\r\n\r\n          function findItem(valueOrIdx) {\r\n            var $item;\r\n            if (langx.isNumber(valueOrIdx)) {\r\n              $item = self._$items.eq(valueOrIdx);\r\n            } else {\r\n              $item = self._$items.filter('[data-value=\"' + valueOrIdx + '\"]');\r\n            }\r\n            return $item;\r\n          } \r\n                 \r\n          function selectOneItem(valueOrIdx) {\r\n            findItem(valueOrIdx).addClass(self.options.classes.active);\r\n          }\r\n\r\n          function unselectOneItem(valueOrIdx) {\r\n            findItem(valueOrIdx).removeClass(self.options.classes.active);\r\n          }\r\n\r\n          if (updates[\"selected\"]) {\r\n            if (this.options.multiSelect) {\r\n            } else {\r\n              unselectOneItem(updates[\"selected\"].oldValue);\r\n              selectOneItem(updates[\"selected\"].value);\r\n            }\r\n\r\n          }\r\n        }\r\n\r\n  });\r\n\r\n  return swt.Listing = Listing;\r\n\r\n});\r\n\r\n\r\n\r\n"]}